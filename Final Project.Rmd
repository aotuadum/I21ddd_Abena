---
title: "Final Project"
author: "Abena Otu-Adum"
date: "1/13/2021"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r global-options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                       warning=FALSE, message=FALSE)
```
### Introduction

#### Background
The data set of focus for this report is the Detail-Disease-Blended data set, whose data is collected by the Agency for Healthcare Research and Quality (AHRQ) and compiled by the Bureau of Economic Analysis (BEA).Its purpose is to outline expenditure, weighted, and unweighted, episode amounts, and other information to follow changes in medical expenditure from the year 2000 to the year 2017 for over 200 specific medical conditions and other medical procedures in the United States. This data was obtained from the BEA's website under the data by topic tab. There, there is a healthcare section, and this data is available as a Microsoft Excel spreadsheet.

#### What I'd Like to Learn
From this data set, I would like to get a better idea of how our medical expenditure spending has changed over time, as well as where people's money goes towards in terms of medical conditions.

#### Primary Questions of Interest
My two questions of interest are as follows: 

  * How have overall medical expenditures, in general and stratified by disease/condition type, trended over time?
  * What proportions of total medical expenditures go to conditions categorized by condition type over time (communicable, noncommunicable, injury)?

My interest in the first question is because we often hear about how healthcare is getting more expensive or that Americans are spending more money on healthcare. Looking at how medical expenditures have changed over time will allow for the observing of spending trends of Americans, especially once the data is stratified.

My interest in the second question is because knowing more information about where exactly our money goes in terms of medical spending can help focus educational and wellness-promotion efforts. Noncommunicable disease, also known as chronic disease, is widely seen as preventable among public health professionals. Knowing this, if it is discovered that a high proportion of total medical expenditure is on noncommunicable disease, it means that there is work to be done in terms of informing and educating the public on lifestyle changes and whatnot to slow or even prevent the onset of these conditions. 


### Processing
```{r Importing Data, echo=FALSE, include=FALSE}
library(dplyr)
library(magrittr)
library(gt)
library(ggplot2)
library(ggpubr)
library(scales)

load("FinalProject.RData")

disease.original <- readxl::read_xlsx("Detail-Disease-Blended-forpub.xlsx", na = "NA")
disease <- disease.original

# naming columns
# Original column names had spaces
colnames(disease)[2] <- "AHRQ.CCS.Condition.Category"
colnames(disease)[3] <- "CCS.Category.Number"
colnames(disease)[4] <- "AHRQ.Category"
colnames(disease)[5] <- "Volatility.Level"
colnames(disease)[6] <- "NIPA.Dollars"
colnames(disease)[7] <- "Uncontrolled.Dollars"
colnames(disease)[8] <- "Number.Of.Episodes"
colnames(disease)[9] <- "Per.Capita.Index"
colnames(disease)[10] <- "Medical.Care.Expenditure.Index"
colnames(disease)[11] <- "Prevalence.Index"
colnames(disease)[12] <- "Per.Capita.Dollars"
colnames(disease)[13] <- "Cost.Per.Case.Dollars"
colnames(disease)[14] <- "Unweighted.MEPS.Patients"
colnames(disease)[15] <- "Share.MEPS.Spending"
colnames(disease)[16] <- "CCS.Chapter.Number"
colnames(disease)[17] <- "CCS.Chapter"
colnames(disease)[18] <- "CCS.Chapter.Dollars.Billions"
colnames(disease)[19] <- "CCS.Category"

# assigning observation ID
disease$disease.ID <- rownames(disease)

```
#### Missing Data
My first action in terms of identifying missing data was using the is.na function on each column in my "dirty" data frame, which I've named **disease**. To demonstrate, below is the code for using is.na on the column **Year**.
``` {r Using is.na}
head(is.na(disease$Year))
```
When the head function isn't used, the output is very overwhelming. This is due to the data frame in question, **disease** , having 5,817 rows. Additionally, data frame **disease** has 19 columns, not including the observation ID column that I derived. That being said, the next step in identifying the missing values within my data frame was to create binary flags. Again, to demonstrate, below is the code for the "Year" column.
``` {r Binary Flags, echo = FALSE, include = FALSE}
disease$AHRQ.CCS.Condition.Category.flag <- ifelse(
  is.na(disease$AHRQ.CCS.Condition.Category), 1, 0
  )
disease$CCS.Category.Number.flag <- ifelse(
  is.na(disease$CCS.Category.Number), 1, 0
  )
disease$AHRQ.Category.flag <- ifelse(
  is.na(disease$AHRQ.Category), 1, 0
  )
disease$Volatility.Level.flag <- ifelse(
  is.na(disease$Volatility.Level), 1, 0
  )
disease$NIPA.Dollars.flag <- ifelse(
  is.na(disease$NIPA.Dollars), 1, 0
  )
disease$Uncontrolled.Dollars.flag <- ifelse(
  is.na(disease$Uncontrolled.Dollars), 1, 0
  )
disease$Number.Of.Episodes.flag <- ifelse(
  is.na(disease$Number.Of.Episodes), 1, 0
  )
disease$Per.Capita.Index.flag <- ifelse(
  is.na(disease$Per.Capita.Index), 1, 0
  )
disease$Medical.Care.Expenditure.Index.flag <- ifelse(
  is.na(disease$Medical.Care.Expenditure.Index), 1, 0
  )
disease$Prevalence.Index.flag <- ifelse(
  is.na(disease$Prevalence.Index), 1, 0
  )
disease$Per.Capita.Dollars.flag <- ifelse(
  is.na(disease$Per.Capita.Dollars), 1, 0
  )
disease$Cost.Per.Case.Dollars.flag <- ifelse(
  is.na(disease$Cost.Per.Case.Dollars), 1, 0
  )
disease$Unweighted.MEPS.Patients.flag <- ifelse(
  is.na(disease$Unweighted.MEPS.Patients), 1, 0
  )
disease$Share.MEPS.Spending.flag <- ifelse(
  is.na(disease$Share.MEPS.Spending), 1, 0
  )
disease$CCS.Chapter.Number.flag <- ifelse(
  is.na(disease$CCS.Chapter.Number), 1, 0
  )
disease$CCS.Chapter.flag <- ifelse(
  is.na(disease$CCS.Chapter), 1, 0
  )
disease$CCS.Chapter.Dollars.Billions.flag <- ifelse(
  is.na(disease$CCS.Chapter.Dollars.Billions), 1, 0
  )
disease$CCS.Category.flag <- ifelse(
  is.na(disease$CCS.Category), 1, 0
  )
```
```{r Year Binary Flag}
disease$Year.flag <- ifelse(
  is.na(disease$Year), 1, 0
  )
head(disease$Year.flag)
```
While still large, using a binary flag has made finding missing values much easier by displaying numbers as opposed to text. From there, I looked at the **Year** column within the data frame **disease**, for logically, this is not a column that should have missing values.
``` {r Year Grep}
length(grep(1, disease$Year.flag))
```
By nesting the grep and length functions, we learn that the column **Year** has 3 missing values, which is odd. 
``` {r Year Missing}
grep(1, disease$Year.flag)
```
Using the grep function again, we learn that the rows in which column **Year** has missing values are rows 5,815 through 5,817. I also checked the remaining columns to see if they also had values missing in the same rows.
```{r Other Columns Missing, eval = FALSE}
as.list(disease[5815, 1:19])
as.list(disease[5816, 1:19])
as.list(disease[5817, 1:19])
```
By using the as.list function on the indexed **disease** data frame, we learn that every column has missing values in these 3 rows. Thankfully, this is to be expected, for in the Excel spreadsheet the data was read in from, there was text in these columns that wasn't limited to any particular cell. When it was read into R, it must have gotten compromised. Given this information, I felt as though removing these rows was appropriate. I did so below.
``` {r Removing Missing Columns}
disease <- disease[1:5814, ]
```
I am still not sure if and where there are other missing values in this data frame. Again, I utilize a nested length and grep function to count the number of missing values in each column. While most returned a length of zero, others did not. The latter are shown below.
``` {r Counting Missings}
length(grep(1, disease$Volatility.Level.flag))
length(grep(1, disease$Share.MEPS.Spending.flag))
length(grep(1, disease$CCS.Chapter.Number.flag))
length(grep(1, disease$CCS.Chapter.flag))
length(grep(1, disease$CCS.Chapter.Dollars.Billions.flag))
length(grep(1, disease$CCS.Category.flag))
```
Notably, columns **Volatility.Level**, **CCS.Chapter.Number**, **CCS.Chapter**, **CCS.Chapter.Dollars.Billions**, and **CCS.Category** have the same amount of missing values. Chances are that the missing values are in the same rows for all 5 columns. I checked this below by subsetting the **disease** data frame using the filter function for the five columns, and selecting the column **AHRQ.CCS.Condition.Category**, which entails every medical condition included in the data frame. I also used the unique function to account for repeats, for the data frame's structure involves each condition repeating 18 times in a row to account from years 2000 to 2017. I then made this into a list for my own viewership in the console.
```{r 5 Missing Columns}
disease %>% 
  filter(Volatility.Level.flag == 1, 
         CCS.Chapter.Number.flag == 1, 
         CCS.Chapter.flag == 1,
         CCS.Category.flag == 1) %>% 
  select(AHRQ.CCS.Condition.Category) %>% 
  unique() %>% 
  as.list()
```
From this list, we see that every condition that has missing values in its respective row is one with the suffix "_AHRQ" at the end. Anything in the **AHRQ.CCS.Condition.Category** column with a "_AHRQ" ending is a summary of all specific conditions that fall under that same category. That being said, given the variables  filtered, it makes sense that the values are missing because they are not specific conditions that warrant any CCS information, CCS being the Clinical Classifications Software. This is how the Agency for Health Research and Quality, the original collectors of the data, classify specific medical conditions. Again, the rows with missing values are not specific medical conditions, so they have no CCS connection. I will not be removing these rows, for I plan on using them for my analysis for simplicity's sake. I feel comfortable doing so due to the five columns that house the missing values not being included in my analysis.

As for the **Share.MEPS.Spending** column, the number of missing values was higher that the others. I chose to look at this separately using a similar subsetting strategy.
``` {r 1 Missing Column}
disease %>% 
  filter(Share.MEPS.Spending.flag == 1) %>% 
  select(AHRQ.CCS.Condition.Category) %>% 
  unique() %>% 
  as.list()
```
Like before, the summarized observations aren't included in the original data set where the data
for this column is derived from, so it will make sense if those are missing. As for observations
that don't end in "_AHRQ, according to the AHRQ, the original collectors of this data, 
they had changes the classification systems for the MEPS, or the Medical Expenditure Panels Survey, data, which is used to calculate the values of this column. What's missing here was not included in their system initially.So not only is this not concerning, I also will not be using this variable in my analysis as I'm mainly focused on expenditure, so i won't remove the observations the missing values correspond to.

Now that all missing values have been discovered and explained, I am ready to being the process of isolating my variables of interest.


#### Variable Creation and Coding
Before isolating any variables, I created a column of factor variables within the **disease** data frame. I decided to do this in order to stratify the data in terms of change in medical expenditure over time, and to also answer my question as to what the makeup of each year's expenditure is. The factor variables that I created consider each medical condition category's (observations in the **AHRQ.CCS.Condition.Category** column with the _AHRQ suffix) disease type. There are 5 possible factors in the context of the **disease** data frame, but in practice, we'll only be focusing on 4 of them.
``` {r Factor Variable Creation: Part 1}
Communicable <- c("Skin disorders_AHRQ",
                  "Infectious diseases_AHRQ", 
                  "Acute bronchitis and URI_AHRQ", 
                  "Other eye disorders_AHRQ",
                  "Pneumonia_AHRQ",
                  "Urinary tract infections_AHRQ",
                  "Otitis media_AHRQ",
                  "Appendicitis_AHRQ",
                  "Intestinal infection_AHRQ",
                  "Influenza_AHRQ",
                  "CNS infection_AHRQ",
                  "Tonsillitis_AHRQ")


Noncommunicable <- c("Heart conditions_AHRQ",
                     "COPD, asthma_AHRQ",
                     "Cancer_AHRQ",
                     "Mental disorders_AHRQ",
                     "Osteoarthritis and other non-traumatic joint disorders_AHRQ",
                     "Diabetes mellitus_AHRQ",
                     "Hypertension_AHRQ",
                     "Back problems_AHRQ",
                     "Kidney disease_AHRQ",
                     "Systemic lupus and connective tissues disorders_AHRQ",
                     "Hyperlipidemia_AHRQ",
                     "Other CNS disorders_AHRQ",
                     "Other circulatory conditions arteries, veins, and lymphatics_AHRQ",
                     "Other GI_AHRQ",
                     "Other endocrine, nutritionial and immune disorder_AHRQ",
                     "Other bone and musculoskeletal disease_AHRQ",
                     "Cerebrovascular disease_AHRQ",
                     "Female genital disorders, and contraception_AHRQ",
                     "Disorders of the upper GI_AHRQ",
                     "Non-malignant neoplasm_AHRQ",
                     "Gallbladder, pancreatic, and liver disease_AHRQ",
                     "Other stomach and intestinal disorders_AHRQ",
                     "Other urinary_AHRQ",
                     "Cataract_AHRQ",
                     "Hereditary, degenerative and other nervous system disorders_AHRQ",
                     "Anemia and other deficiencies_AHRQ",
                     "Thyroid disease_AHRQ",                                             
                     "Hemorrhagic, coagulation, and disorders of white blood wells_AHRQ",
                     "Male genital disorders_AHRQ",                                      
                     "Epilepsy and convulsions_AHRQ",                                    
                     "Non-malignant breast disease_AHRQ",                                
                     "Congenital anomalies_AHRQ",                                        
                     "Glaucoma_AHRQ",                                                    
                     "Hernias_AHRQ",                                                     
                     "Perinatal conditions_AHRQ",
                     "Disorders of mouth and esophagus_AHRQ",   
                     "Paralysis_AHRQ")


Injury <- c("Trauma-related disorders_AHRQ",
            "Poisoning by medical and non-medical substances_AHRQ",
            "Coma, brain damage_AHRQ")


Other <- c("Other care and screening_AHRQ",
           "Symptoms_AHRQ",
           "Residual codes_AHRQ",
           "Complications of surgery or device_AHRQ",
           "Normal birth/live born_AHRQ",
           "Headache_AHRQ",
           "Complications of pregnancy and birth_AHRQ",
           "Allergic reactions_AHRQ")
```
Above, I defined the 4 categories that we'll focus on: **communicable diseases**, which refers to diseases that are caused by pathogens, **noncommunicable diseases**, or chronic conditions, which are disease that are not caused by pathogens, **injuries**, which are the result of an exertion of energy to the body, and **other**, other conditions or areas of spending that did not fit into the prior 3 categories. Below, I used a series of nested ifelse functions to create these 4 categories, along with a **not included** category for everything else, to create my factor variables in the column **Disease.Type** within the data frame **disease**.
```{r Factor Variable Creation: Part 2}
disease$Disease.Type <- ifelse(disease$AHRQ.CCS.Condition.Category %in% Communicable, 'Communicable',
                        ifelse(disease$AHRQ.CCS.Condition.Category %in% Noncommunicable, 'Noncommunicable',
                        ifelse(disease$AHRQ.CCS.Condition.Category %in% Injury, 'Injury',
                        ifelse(disease$AHRQ.CCS.Condition.Category %in% Other, 'Other', 'Not Included'))))
disease$Disease.Type <- as.factor(disease$Disease.Type)
class(disease$Disease.Type)
```
Now that my factor variables are created, I can isolate my variables of interest, which include the following:

  * **Year**
    + A column of years starting with 2000 and ending with 2017. Because this is column, as opposed to a row, each year is repeated over and over throughout the column to account for every disease's variables over time. This column, which was numeric, was not manipulated by me at all.
  * **AHRQ.CCS.Condition.Category**
    + A column of medical conditions that whose observed medical expenditure has been observed by the Agency of Healthcare Research and Quality. For the sake of simplicity, I will be using the summarized versions of each medical condition in my analysis, which are those with the _AHRQ ending. Because of how the original data set was organized (or lack thereof), in addition to my interest in overall and categorized expenditure, working with each individual disease would be overkill for my purposes. This column of characters is filtered out using the factor variables that I created, which is seen below.
  * **NIPA.Dollars**
    + A column of numeric values that each correspond to a medical condition. Its source, the National Income Personal Account, which is calculated by the Bureau of Economic Analysis, is where the actual expenditure for each disease comes from. To account for discrepancy, this account is blended with several accounts and surveys, such as the MEPS which was mentioned previously. While I did not manipulate this column, I did use to to create other columns, which I will touch upon later.
  * **Disease.Type**
    + This is the column of factor variables that I derived. To check my work in their derivation, I used a nested unique and grep function to get a count of how many diseases I needed to account for, as well as their names. I went through the list and categorized as I saw fit, and counted the  dimensions of the values that resulted from those categorizations. I knew I was correct when the numbers equaled each other. While this column is not as functional as I'd like them to be due to the structure of this data set, I was still able to use the factor variables for filtering and indexing, which I will show later.

I isolated these variables, using a pipeline of filtering by disease types that were included and arranging by year and disease type to a new data frame which I called **disease.clean**.
```{r Creating disease.clean}
disease.clean <- disease %>% 
filter(Disease.Type != "Not Included") %>% 
  arrange(Year, Disease.Type) %>% 
  select(Year, AHRQ.CCS.Condition.Category, NIPA.Dollars, Disease.Type)
```
This is only the beginning of my variables of interest. Using this 4 variables in **disease.clean**, I needed to manipulate the yearly total expenditure, the yearly categorized expenditure, and the proportions of every year's expenditure for each category. To do this, I made a new data frame for each year by filtering **disease.clean** by year and arranging by disease type. Then, I utilized a for loop  for every year in which I created a new column within the newly created data frame with the sum of the **NIPA.Dollars** column for that year, as well as another new column with the percentage each disease contributed to the total expenditure for that year by dividing the  yearly **NIPA.Dollars** column by the yearly sum column. As an example, below is how I created the year 2000's data frame, total sum, and percentage contributions. 
```{r Defining i, include = FALSE}
i = 1
```
``` {r Year 2000 Derivation}
# 2000
disease.clean.2000 <- disease.clean %>%
  filter(Year == 2000) %>% 
  arrange(Disease.Type)

disease.clean.2000$Percentage.2000 <- 0

for (i in 1:60) {
  disease.clean.2000$Sum.2000 <- sum(disease.clean.2000$NIPA.Dollars)
  disease.clean.2000$Percentage.2000[i] <- 
    (disease.clean.2000$NIPA.Dollars[i] / disease.clean.2000$Sum.2000[i]) 
}
```
I used a loop for the creation of the sum and percentage columns to be concise and utilize the indexes of each disease in order to use the correct **NIPA.Dollar** value respectively. I was unable to create a proper loop that did this every single year in one loop, so I repeated the above code for every year by changing the year itself in the code.
``` {r Derivation of All the Other Years, include = FALSE, echo = FALSE}
# 2001
disease.clean.2001 <- disease.clean %>%
  filter(Year == 2001) %>% 
  arrange(Disease.Type)

disease.clean.2001$Percentage.2001 <- 0

for (i in 1:60) {
  disease.clean.2001$Sum.2001 <- sum(disease.clean.2001$NIPA.Dollars)
  disease.clean.2001$Percentage.2001[i] <- 
    (disease.clean.2001$NIPA.Dollars[i] / disease.clean.2001$Sum.2001[i]) 
}


# 2002
disease.clean.2002 <- disease.clean %>%
  filter(Year == 2002) %>% 
  arrange(Disease.Type)

disease.clean.2002$Percentage.2002 <- 0

for (i in 1:60) {
  disease.clean.2002$Sum.2002 <- sum(disease.clean.2002$NIPA.Dollars)
  disease.clean.2002$Percentage.2002[i] <- 
    (disease.clean.2002$NIPA.Dollars[i] / disease.clean.2002$Sum.2002[i]) 
}


# 2003
disease.clean.2003 <- disease.clean %>%
  filter(Year == 2003) %>% 
  arrange(Disease.Type)

disease.clean.2003$Percentage.2003 <- 0

for (i in 1:60) {
  disease.clean.2003$Sum.2003 <- sum(disease.clean.2003$NIPA.Dollars)
  disease.clean.2003$Percentage.2003[i] <- 
    (disease.clean.2003$NIPA.Dollars[i] / disease.clean.2003$Sum.2003[i]) 
}


# 2004
disease.clean.2004 <- disease.clean %>%
  filter(Year == 2004) %>% 
  arrange(Disease.Type)

disease.clean.2004$Percentage.2004 <- 0

for (i in 1:60) {
  disease.clean.2004$Sum.2004 <- sum(disease.clean.2004$NIPA.Dollars)
  disease.clean.2004$Percentage.2004[i] <- 
    (disease.clean.2004$NIPA.Dollars[i] / disease.clean.2004$Sum.2004[i]) 
}


# 2005
disease.clean.2005 <- disease.clean %>%
  filter(Year == 2005) %>% 
  arrange(Disease.Type)

disease.clean.2005$Percentage.2005 <- 0

for (i in 1:60) {
  disease.clean.2005$Sum.2005 <- sum(disease.clean.2005$NIPA.Dollars)
  disease.clean.2005$Percentage.2005[i] <- 
    (disease.clean.2005$NIPA.Dollars[i] / disease.clean.2005$Sum.2005[i]) 
}


# 2006
disease.clean.2006 <- disease.clean %>%
  filter(Year == 2006) %>% 
  arrange(Disease.Type)

disease.clean.2006$Percentage.2006 <- 0

for (i in 1:60) {
  disease.clean.2006$Sum.2006 <- sum(disease.clean.2006$NIPA.Dollars)
  disease.clean.2006$Percentage.2006[i] <- 
    (disease.clean.2006$NIPA.Dollars[i] / disease.clean.2006$Sum.2006[i]) 
}


# 2007
disease.clean.2007 <- disease.clean %>%
  filter(Year == 2007) %>% 
  arrange(Disease.Type)

disease.clean.2007$Percentage.2007 <- 0

for (i in 1:60) {
  disease.clean.2007$Sum.2007 <- sum(disease.clean.2007$NIPA.Dollars)
  disease.clean.2007$Percentage.2007[i] <- 
    (disease.clean.2007$NIPA.Dollars[i] / disease.clean.2007$Sum.2007[i]) 
}


# 2008
disease.clean.2008 <- disease.clean %>%
  filter(Year == 2008) %>% 
  arrange(Disease.Type)

disease.clean.2008$Percentage.2008 <- 0

for (i in 1:60) {
  disease.clean.2008$Sum.2008 <- sum(disease.clean.2008$NIPA.Dollars)
  disease.clean.2008$Percentage.2008[i] <- 
    (disease.clean.2008$NIPA.Dollars[i] / disease.clean.2008$Sum.2008[i]) 
}


# 2009
disease.clean.2009 <- disease.clean %>%
  filter(Year == 2009) %>% 
  arrange(Disease.Type)

disease.clean.2009$Percentage.2009 <- 0

for (i in 1:60) {
  disease.clean.2009$Sum.2009 <- sum(disease.clean.2009$NIPA.Dollars)
  disease.clean.2009$Percentage.2009[i] <- 
    (disease.clean.2009$NIPA.Dollars[i] / disease.clean.2009$Sum.2009[i]) 
}


# 2010
disease.clean.2010 <- disease.clean %>%
  filter(Year == 2010) %>% 
  arrange(Disease.Type)

disease.clean.2010$Percentage.2010 <- 0

for (i in 1:60) {
  disease.clean.2010$Sum.2010 <- sum(disease.clean.2010$NIPA.Dollars)
  disease.clean.2010$Percentage.2010[i] <- 
    (disease.clean.2010$NIPA.Dollars[i] / disease.clean.2010$Sum.2010[i]) 
}


# 2011
disease.clean.2011 <- disease.clean %>%
  filter(Year == 2011) %>% 
  arrange(Disease.Type)

disease.clean.2011$Percentage.2011 <- 0

for (i in 1:60) {
  disease.clean.2011$Sum.2011 <- sum(disease.clean.2011$NIPA.Dollars)
  disease.clean.2011$Percentage.2011[i] <- 
    (disease.clean.2011$NIPA.Dollars[i] / disease.clean.2011$Sum.2011[i]) 
}


# 2012
disease.clean.2012 <- disease.clean %>%
  filter(Year == 2012) %>% 
  arrange(Disease.Type)

disease.clean.2012$Percentage.2012 <- 0

for (i in 1:60) {
  disease.clean.2012$Sum.2012 <- sum(disease.clean.2012$NIPA.Dollars)
  disease.clean.2012$Percentage.2012[i] <- 
    (disease.clean.2012$NIPA.Dollars[i] / disease.clean.2012$Sum.2012[i]) 
}


# 2013
disease.clean.2013 <- disease.clean %>%
  filter(Year == 2013) %>% 
  arrange(Disease.Type)

disease.clean.2013$Percentage.2013 <- 0

for (i in 1:60) {
  disease.clean.2013$Sum.2013 <- sum(disease.clean.2013$NIPA.Dollars)
  disease.clean.2013$Percentage.2013[i] <- 
    (disease.clean.2013$NIPA.Dollars[i] / disease.clean.2013$Sum.2013[i]) 
}


# 2014
disease.clean.2014 <- disease.clean %>%
  filter(Year == 2014) %>% 
  arrange(Disease.Type)

disease.clean.2014$Percentage.2014 <- 0

for (i in 1:60) {
  disease.clean.2014$Sum.2014 <- sum(disease.clean.2014$NIPA.Dollars)
  disease.clean.2014$Percentage.2014[i] <- 
    (disease.clean.2014$NIPA.Dollars[i] / disease.clean.2014$Sum.2014[i]) 
}


# 2015
disease.clean.2015 <- disease.clean %>%
  filter(Year == 2015) %>% 
  arrange(Disease.Type)

disease.clean.2015$Percentage.2015 <- 0

for (i in 1:60) {
  disease.clean.2015$Sum.2015 <- sum(disease.clean.2015$NIPA.Dollars)
  disease.clean.2015$Percentage.2015[i] <- 
    (disease.clean.2015$NIPA.Dollars[i] / disease.clean.2015$Sum.2015[i]) 
}


# 2016
disease.clean.2016 <- disease.clean %>%
  filter(Year == 2016) %>% 
  arrange(Disease.Type)

disease.clean.2016$Percentage.2016 <- 0

for (i in 1:60) {
  disease.clean.2016$Sum.2016 <- sum(disease.clean.2016$NIPA.Dollars)
  disease.clean.2016$Percentage.2016[i] <- 
    (disease.clean.2016$NIPA.Dollars[i] / disease.clean.2016$Sum.2016[i]) 
}


# 2017
disease.clean.2017 <- disease.clean %>%
  filter(Year == 2017) %>% 
  arrange(Disease.Type)

disease.clean.2017$Percentage.2017 <- 0

for (i in 1:60) {
  disease.clean.2017$Sum.2017 <- sum(disease.clean.2017$NIPA.Dollars)
  disease.clean.2017$Percentage.2017[i] <- 
    (disease.clean.2017$NIPA.Dollars[i] / disease.clean.2017$Sum.2017[i]) 
}
```
I checked my work with the percentage columns by summing them. If I did it correctly, they should add up to 1. Here is an example of what I did for the year 2000.
```{r Checking Percentages Work}
sum(disease.clean.2000$Percentage.2000)
```
To finish my data manipulations, I has to put every year's data into one condensed data frame. Because of the odd nature of the original data set's structure, in addition to most of the variables of interest being derived, I could not use the merge function. Instead, I created a new data frame, called **disease.clean.totals**, and replaced each row with the first row of each year to create a data frame in which the columns were the **Year** and **Sum.All**,  which was the total expenditure for each year. I chose the first row for each year to replace its respective row in **disease.clean**totals because I previously used the sum function to find the total expenditure for each year, which created a column of the same value for each year. There isn't any significance to the first row in the context of this data frame, I just chose is for simplicity. I first created a numeric called **cols** with the numbers 1 and 6 in them; they correspond to the columns in **disease.clean** that I wanted for **disease.clean.total** : **Year** and **Sum.Insert.Year.Here**, which would become **Year** and **Sum.All** in the new data frame. Below demonstrates how I did this, using year 2000 to serve as a template and year 2001 as the first replacement.
``` {r Creating disease.clean.total}
cols <- c(1,6)
disease.clean.total <- disease.clean.2000[1:18,cols]
colnames(disease.clean.total)[2] <- "Sum.All"


# adding 2001
disease.clean.total[2,] <- disease.clean.2001[1,cols]
```
``` {r Creating the rest of disease.clean.total, include = FALSE, echo = FALSE}
# adding 2002
disease.clean.total[3,] <- disease.clean.2002[1,cols]


# adding 2003
disease.clean.total[4,] <- disease.clean.2003[1,cols]


# adding 2004
disease.clean.total[5,] <- disease.clean.2004[1,cols]


# adding 2005
disease.clean.total[6,] <- disease.clean.2005[1,cols]


# adding 2006
disease.clean.total[7,] <- disease.clean.2006[1,cols]


# adding 2007
disease.clean.total[8,] <- disease.clean.2007[1,cols]


# adding 2008
disease.clean.total[9,] <- disease.clean.2008[1,cols]


# adding 2009
disease.clean.total[10,] <- disease.clean.2009[1,cols]


# adding 2010
disease.clean.total[11,] <- disease.clean.2010[1,cols]


# adding 2011
disease.clean.total[12,] <- disease.clean.2011[1,cols]


# adding 2012
disease.clean.total[13,] <- disease.clean.2012[1,cols]


# adding 2013
disease.clean.total[14,] <- disease.clean.2013[1,cols]


# adding 2014
disease.clean.total[15,] <- disease.clean.2014[1,cols]


# adding 2015
disease.clean.total[16,] <- disease.clean.2015[1,cols]


# adding 2016
disease.clean.total[17,] <- disease.clean.2016[1,cols]


# adding 2017
disease.clean.total[18,] <- disease.clean.2017[1,cols]
```
The data frame **disease.clean.total** after the previous manipulation looks like so:
``` {r Printing disease.clean.total}
print(disease.clean.total)
```
Now, I will create my percentages data frame, **disease.clean.percent**, which will have the same structure as **disease.clean.total** with the exception of 4 additional columns: **Communicable**, **Noncommunicable**, **Injury**, and **Other**. I begin this process by using the function cbind.data.frame to bind 4 columns of **disease.clean.total$Year** as a base for this 18 x 5 data frame. Much like **disease.clean.total**, I will replace the values in each row by undergoing the same process. However, this time, additional steps are done, such as renaming the columns in **disease.clean.percent** and creating indexes for each disease type to help make this tedious process easier.
``` {Prep for Creating disease.clean.percent}
disease.clean.percent <- cbind.data.frame(disease.clean.total$Year, 
                                          disease.clean.total$Year, 
                                          disease.clean.total$Year,
                                          disease.clean.total$Year,
                                          disease.clean.total$Year)
# the above data frame creation was to create an 18 x 5 data frame; values will be replaced

# rename columns in disease.clean.percent
colnames(disease.clean.percent) <- c("Year", "Communicable", "Noncommunicable", "Injury", "Other")


# finding indexes for each disease type
# indexes for disease type
Communicable.index <- grep("Communicable", 
                           disease.clean.2000$Disease.Type, 
                           value = FALSE, 
                           ignore.case = FALSE)
Noncommunicable.index <- grep("Noncommunicable",
                              disease.clean.2000$Disease.Type,
                              value = FALSE,
                              ignore.case = FALSE)
Injury.index <- grep("Injury",
                              disease.clean.2000$Disease.Type,
                              value = FALSE,
                              ignore.case = FALSE)
Other.index <- grep("Other",
                              disease.clean.2000$Disease.Type,
                              value = FALSE,
                              ignore.case = FALSE)
```
After running the above processes, I am reading to start replacing the values in the rows. Below details the code I repeated throughout my script, using year 2000 as an example.
```{r Creating disease.clean.percent: 2000 row}
# adding 2000
disease.clean.percent[1,"Communicable"] <- sum(disease.clean.2000$Percentage.2000[Communicable.index])
disease.clean.percent[1,"Noncommunicable"] <- sum(disease.clean.2000$Percentage.2000[Noncommunicable.index])
disease.clean.percent[1,"Injury"] <- sum(disease.clean.2000$Percentage.2000[Injury.index])
disease.clean.percent[1,"Other"] <- sum(disease.clean.2000$Percentage.2000[Other.index])
```
```{r Creating disease.clean.percent: the rest of the rows}, include = FALSE, echo=FALSE}

# adding 2001
disease.clean.percent[2,"Communicable"] <- sum(disease.clean.2001$Percentage.2001[Communicable.index])
disease.clean.percent[2,"Noncommunicable"] <- sum(disease.clean.2001$Percentage.2001[Noncommunicable.index])
disease.clean.percent[2,"Injury"] <- sum(disease.clean.2001$Percentage.2001[Injury.index])
disease.clean.percent[2,"Other"] <- sum(disease.clean.2001$Percentage.2001[Other.index])


# adding 2002
disease.clean.percent[3,"Communicable"] <- sum(disease.clean.2002$Percentage.2002[Communicable.index])
disease.clean.percent[3,"Noncommunicable"] <- sum(disease.clean.2002$Percentage.2002[Noncommunicable.index])
disease.clean.percent[3,"Injury"] <- sum(disease.clean.2002$Percentage.2002[Injury.index])
disease.clean.percent[3,"Other"] <- sum(disease.clean.2002$Percentage.2002[Other.index])


# adding 2003
disease.clean.percent[4,"Communicable"] <- sum(disease.clean.2003$Percentage.2003[Communicable.index])
disease.clean.percent[4,"Noncommunicable"] <- sum(disease.clean.2003$Percentage.2003[Noncommunicable.index])
disease.clean.percent[4,"Injury"] <- sum(disease.clean.2003$Percentage.2003[Injury.index])
disease.clean.percent[4,"Other"] <- sum(disease.clean.2003$Percentage.2003[Other.index])


# adding 2004
disease.clean.percent[5,"Communicable"] <- sum(disease.clean.2004$Percentage.2004[Communicable.index])
disease.clean.percent[5,"Noncommunicable"] <- sum(disease.clean.2004$Percentage.2004[Noncommunicable.index])
disease.clean.percent[5,"Injury"] <- sum(disease.clean.2004$Percentage.2004[Injury.index])
disease.clean.percent[5,"Other"] <- sum(disease.clean.2004$Percentage.2004[Other.index])


# adding 2005
disease.clean.percent[6,"Communicable"] <- sum(disease.clean.2005$Percentage.2005[Communicable.index])
disease.clean.percent[6,"Noncommunicable"] <- sum(disease.clean.2005$Percentage.2005[Noncommunicable.index])
disease.clean.percent[6,"Injury"] <- sum(disease.clean.2005$Percentage.2005[Injury.index])
disease.clean.percent[6,"Other"] <- sum(disease.clean.2005$Percentage.2005[Other.index])


# adding 2006
disease.clean.percent[7,"Communicable"] <- sum(disease.clean.2006$Percentage.2006[Communicable.index])
disease.clean.percent[7,"Noncommunicable"] <- sum(disease.clean.2006$Percentage.2006[Noncommunicable.index])
disease.clean.percent[7,"Injury"] <- sum(disease.clean.2006$Percentage.2006[Injury.index])
disease.clean.percent[7,"Other"] <- sum(disease.clean.2006$Percentage.2006[Other.index])


# adding 2007
disease.clean.percent[8,"Communicable"] <- sum(disease.clean.2007$Percentage.2007[Communicable.index])
disease.clean.percent[8,"Noncommunicable"] <- sum(disease.clean.2007$Percentage.2007[Noncommunicable.index])
disease.clean.percent[8,"Injury"] <- sum(disease.clean.2007$Percentage.2007[Injury.index])
disease.clean.percent[8,"Other"] <- sum(disease.clean.2007$Percentage.2007[Other.index])


# adding 2008
disease.clean.percent[9,"Communicable"] <- sum(disease.clean.2008$Percentage.2008[Communicable.index])
disease.clean.percent[9,"Noncommunicable"] <- sum(disease.clean.2008$Percentage.2008[Noncommunicable.index])
disease.clean.percent[9,"Injury"] <- sum(disease.clean.2008$Percentage.2008[Injury.index])
disease.clean.percent[9,"Other"] <- sum(disease.clean.2008$Percentage.2008[Other.index])


# adding 2009
disease.clean.percent[10,"Communicable"] <- sum(disease.clean.2009$Percentage.2009[Communicable.index])
disease.clean.percent[10,"Noncommunicable"] <- sum(disease.clean.2009$Percentage.2009[Noncommunicable.index])
disease.clean.percent[10,"Injury"] <- sum(disease.clean.2009$Percentage.2009[Injury.index])
disease.clean.percent[10,"Other"] <- sum(disease.clean.2009$Percentage.2009[Other.index])


# adding 2010
disease.clean.percent[11,"Communicable"] <- sum(disease.clean.2010$Percentage.2010[Communicable.index])
disease.clean.percent[11,"Noncommunicable"] <- sum(disease.clean.2010$Percentage.2010[Noncommunicable.index])
disease.clean.percent[11,"Injury"] <- sum(disease.clean.2010$Percentage.2010[Injury.index])
disease.clean.percent[11,"Other"] <- sum(disease.clean.2010$Percentage.2010[Other.index])


# adding 2011
disease.clean.percent[12,"Communicable"] <- sum(disease.clean.2011$Percentage.2011[Communicable.index])
disease.clean.percent[12,"Noncommunicable"] <- sum(disease.clean.2011$Percentage.2011[Noncommunicable.index])
disease.clean.percent[12,"Injury"] <- sum(disease.clean.2011$Percentage.2011[Injury.index])
disease.clean.percent[12,"Other"] <- sum(disease.clean.2011$Percentage.2011[Other.index])


# adding 2012
disease.clean.percent[13,"Communicable"] <- sum(disease.clean.2012$Percentage.2012[Communicable.index])
disease.clean.percent[13,"Noncommunicable"] <- sum(disease.clean.2012$Percentage.2012[Noncommunicable.index])
disease.clean.percent[13,"Injury"] <- sum(disease.clean.2012$Percentage.2012[Injury.index])
disease.clean.percent[13,"Other"] <- sum(disease.clean.2012$Percentage.2012[Other.index])


# adding 2013
disease.clean.percent[14,"Communicable"] <- sum(disease.clean.2013$Percentage.2013[Communicable.index])
disease.clean.percent[14,"Noncommunicable"] <- sum(disease.clean.2013$Percentage.2013[Noncommunicable.index])
disease.clean.percent[14,"Injury"] <- sum(disease.clean.2013$Percentage.2013[Injury.index])
disease.clean.percent[14,"Other"] <- sum(disease.clean.2013$Percentage.2013[Other.index])


# adding 2014
disease.clean.percent[15,"Communicable"] <- sum(disease.clean.2014$Percentage.2014[Communicable.index])
disease.clean.percent[15,"Noncommunicable"] <- sum(disease.clean.2014$Percentage.2014[Noncommunicable.index])
disease.clean.percent[15,"Injury"] <- sum(disease.clean.2014$Percentage.2014[Injury.index])
disease.clean.percent[15,"Other"] <- sum(disease.clean.2014$Percentage.2014[Other.index])


# adding 2015
disease.clean.percent[16,"Communicable"] <- sum(disease.clean.2015$Percentage.2015[Communicable.index])
disease.clean.percent[16,"Noncommunicable"] <- sum(disease.clean.2015$Percentage.2015[Noncommunicable.index])
disease.clean.percent[16,"Injury"] <- sum(disease.clean.2015$Percentage.2015[Injury.index])
disease.clean.percent[16,"Other"] <- sum(disease.clean.2015$Percentage.2015[Other.index])


# adding 2016
disease.clean.percent[17,"Communicable"] <- sum(disease.clean.2016$Percentage.2016[Communicable.index])
disease.clean.percent[17,"Noncommunicable"] <- sum(disease.clean.2016$Percentage.2016[Noncommunicable.index])
disease.clean.percent[17,"Injury"] <- sum(disease.clean.2016$Percentage.2016[Injury.index])
disease.clean.percent[17,"Other"] <- sum(disease.clean.2016$Percentage.2016[Other.index])


# adding 2017
disease.clean.percent[18,"Communicable"] <- sum(disease.clean.2017$Percentage.2017[Communicable.index])
disease.clean.percent[18,"Noncommunicable"] <- sum(disease.clean.2017$Percentage.2017[Noncommunicable.index])
disease.clean.percent[18,"Injury"] <- sum(disease.clean.2017$Percentage.2017[Injury.index])
disease.clean.percent[18,"Other"] <- sum(disease.clean.2017$Percentage.2017[Other.index])
```
The data frame **disease.clean.percent** at this point looks like so:
```{r printing disease.clean.percent}
print(disease.clean.percent)
```
I then used the percentages as calculated and manipulated into **disease.clean.percent** to calculate the medical expenditure associated with each disease type every year by multiplying the percentage for the disease type in question by the total medical expenditure. For each disease type, I created a new column, which I later rename.
``` {r Creating Disease Type Breakdowns in disease.clean.total}
# calculating total medical expenditure for each disease type
disease.clean.total$Sum.Communicable <- disease.clean.total$Sum.All * disease.clean.percent$Communicable
disease.clean.total$Sum.Noncommunicable <- disease.clean.total$Sum.All * disease.clean.percent$Noncommunicable
disease.clean.total$Sum.Injury <- disease.clean.total$Sum.All * disease.clean.percent$Injury
disease.clean.total$Sum.Other <- disease.clean.total$Sum.All * disease.clean.percent$Other


# changing column names in disease.clean.total
colnames(disease.clean.total) <- c("Year", 
                                   "Total", 
                                   "Communicable", 
                                   "Noncommunicable", 
                                   "Injury", 
                                  "Other")
```
I now have all the data that I'd like to visualize.

### Analysis
#### Total Expenditure Table
To create the total medical expenditures table, I used the function gt, where I sectioned the diseases types in relation to the total expenditure for each year.
``` {r Total Expenditure Table}
  # total expenditure table
disease.clean.total %>% 
  gt(rowname_col = "Year") %>% 
  tab_header(
    title = "Medical Expenditure in the United States from 2000 to 2017",
    subtitle = "in Dollars"
  ) %>% 
  tab_spanner(
    label = "Disease Type",
    columns = vars(Communicable, Noncommunicable, Injury, Other)
  ) %>%
  fmt_number(columns = vars(Total, Communicable, Noncommunicable, Injury, Other),
             suffixing = TRUE) %>% 
  tab_source_note(source_note = "Source: Bureau of Economic Analysis Blended Account, 2020")
```
Each row in this table corresponds to year, and in each year, there is a total expenditure, as well as expenditure as stratified by disease type. What is most noticeable in this table is under the total expenditure column; between 2001 and 2002, Americans go from spending billions of dollars to trillions. This same phenomenon is also present in the noncommunicable disease column, although the switch from billions to trillions doesn't occur until 2008. Overall, though, as time progresses, expenditure appears to increase. This point however, is better addressed on a graph.

#### Total Expenditure Graph
```{r Total Expenditure Graph}
ggplot(data = disease.clean.total,
                      aes(x = Year, y = Total)) +
  geom_line(color = "purple") +
  xlab("Year") +
  ylab("Total Expenditure (in dollars)") +
  ggtitle("Total Medical Expenditure in the United States 2000-2017") +
  theme_bw(base_size = 18) +
  scale_x_discrete(limits = 2000:2017)
```
This graph, created in ggplot2, has year on the x axis and total expenditure in dollars on the y axis. As seen in the table, overall medical expenditure is rising, given the upward trend of the line. The question we have to ask, however, is whether this upward trend holds when we graph by disease type.

#### Total Expenditure by Disease Type Graph
```{r Total Expenditure by Disease Type Graph Setup, results='hide'}
# disease type graphs
# communicable disease
Communicable.graph <- ggplot(data = disease.clean.total,
                             aes(x = Year, y = Communicable)) +
                             geom_line(color = "blue") +
                             xlab("Year") +
                             ylab("Total Expenditure (in dollars)") +
                             theme_bw(base_size = 12) +
            ggtitle("Communicable Expenditure 2000-2017")


# noncommunicable disease
Noncommunicable.graph <- ggplot(data = disease.clean.total,
                             aes(x = Year, y = Noncommunicable)) +
  geom_line(color = "green") +
  xlab("Year") +
  ylab("Total Expenditure (in dollars)") +
  theme_bw(base_size = 12) +
  ggtitle("Noncommunicable Expenditure 2000-2017")


# injury
Injury.graph <- ggplot(data = disease.clean.total,
                             aes(x = Year, y = Injury)) +
  geom_line(color = "red") +
  xlab("Year") +
  ylab("Total Expenditure (in dollars)") +
  theme_bw(base_size = 12) +
  ggtitle("Expenditure on Injuries 2000-2017")


# other
Other.graph <- ggplot(data = disease.clean.total,
                       aes(x = Year, y = Other)) +
  geom_line(color = "orange") +
  xlab("Year") +
  ylab("Total Expenditure (in dollars)") +
  theme_bw(base_size = 12) +
  ggtitle(" Unspecified Expenditure 2000-2017")
```
Using ggplot2, I also graphed  medical expenditure by disease type over time. Because of the issues involving the structure of the original data set and my derivation of the factor variables, I wasn't able to use the facet_wrap function. Instead, I used ggarange to create a grid with each graph. Like the total expenditure graph, year is on the x axis, and total expenditure is on the y axis.
```{r Total Expenditure by Disease Type Graphs}
# combining disease type graphs
ggarrange(Communicable.graph, Noncommunicable.graph, Injury.graph, Other.graph)
```
Again, as seen in the table, medical expenditure is increasing over time, even when stratified by disease type. Every graph shows an upward trend.

#### Proportioned Medical Expenditure Table
My second question of interest involves the proportions of each disease type in the overall medical expenditure for each year. By doing this, we can figure out which disease type causes Americans to spend the most money.
``` {r Percentage Table Setup}
disease.clean.percent$Communicable <- disease.clean.percent$Communicable * 100 %>% 
  round(digits = 2)
disease.clean.percent$Noncommunicable <- disease.clean.percent$Noncommunicable * 100 %>% 
  round(digits = 2)
disease.clean.percent$Injury <- disease.clean.percent$Injury * 100 %>% 
  round(digits = 2)
disease.clean.percent$Other <- disease.clean.percent$Other * 100 %>% 
  round(digits = 2)
```
Back when the disease type columns in ** disease.clean.total** were created, the percentages from **disease.clean.percent** were used. Because of this, the values are not in the form of a percent. To fix this, I multiplied each column by 100 and then rounded each percentage to the tenth's place, the place in which we typically view percentages.
The table of proportions by disease type was also done using gt. The years 2000 to 2017 make up the rows, and each column corresponds to a disease type. 
```{r Percentage Table}
disease.clean.percent %>% 
  gt(rowname_col = "Year") %>% 
  tab_header(
    title = "Medical Expenditure in the United States from 2000 to 2017 Proportioned by Disease Type",
    subtitle = "as a Percentage"
  ) %>% 
  fmt_number(columns = vars(Communicable, Noncommunicable, Injury, Other),
             decimals = 2) %>% 
  tab_source_note(source_note = "Source: Bureau of Economic Analysis Blended Account, 2020")
````
To analyze the table by column, the proportion of communicable disease falls from 2000 to 2004, and rises briefly in 2005, falls again in 2006, rises from 2007 to 2009, falls once more in 2010, and rises from 2011 onward. In the noncommunicable column, the proportion rises and falls back and forth for the first 5 years, and consistently falls from 2006 onward. In the injury column, the proportion of injuries making up medical expenditure fell consistently from 2000 to 2017. As for the other column, the opposite occurs: the proportion of other medical expenditures rose consistently from 2000 to 2017. Overall, every year has noncommunicable disease with the highest proportion, followed by other, then communicable disease, and lastly, injury.

### Conclusion
#### Answering Questions of Interest / Commentary
The questions I was interested in answering were as follows:
  
  * How have overall medical expenditures, in general and stratified by disease/condition type, trended over time?
  * What proportions of total medical expenditures go to conditions categorized by condition type over time (communicable, noncommunicable, injury)?

To answer the first question, medical expenditures that are general and stratified by disease type all trended upward over time. While this is somewhat unsurprising, given what we know about health care in the United States, the follow-up question that comes to mind is why this is the trend. Are Americans getting sicker, or is healthcare getting more expensive? Perhaps both? Either way, it's indicative of a problem with American healthcare.

As for the second question, the highest proportion goes to noncommunicable disease, followed by other diseases, then communicable disease, and lastly injury for every year observed. Again, this is not surprising, given that noncommunicable disease is where chronic conditions lie. The U.S. has a high aging population that is more susceptible to these sorts of diseases than younger individuals, so this likely is why noncommunicable disease is so high. When this data is updated to account for 2020, it will definitely be interesting to see how COVID-19 changes, if at all, the proportion that communicable disease contributes to the overall medical expenditure. One interesting observation is the fact that the other diseases category was the only consistently increasing proportion. Initially, I was surprised, for I was expected this to be the case for noncommunicable disease. However, when you take into account that the contents of the other diseases category, such as screening and complications of surgery or medical devices, it means that the increase is due to its link to noncommunicable diseases, as those are the conditions that result in people getting screened or undergoing surgery.

#### Additional Information to Take Note Of
This data set is updated annually. Depending on when one begins to work on this data, especially in the event that it will be presented publicly, they will have to switch to the more recent data set. There are quite a few missing values that cannot be derived, which may cause researchers to run into problems should those variables be of interest to them. It is likely that questions of interest, such as mine, cannot be answered innately by this data set. Many variables will have to be derived, which makes working with this data set difficult, especially since it was clearly not designed to be used in a program such as R. However, as difficult the data set may be to work with, the questions that it can answer are important not only for the present, bust also the future. The conclusions I've drawn today could easily be used in an education or policy proposal, if not elsewhere. In my humble opinion, that alone makes this data worth working with.